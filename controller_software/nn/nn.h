#ifndef _NN_H_
#define _NN_H_

#define WORD_SCALE (512 / 32)
#define LOG2_WORD_SIZE 2
#define LSU_WIDTH_SCALE (64 / 32)

#define CONV3D_NUM_CONV2D 8
#define CONV3D_OFM_CNT 8

#define LINEAR_IFM_BLK_LEN 16
#define LINEAR_OFM_BLK_LEN 64
#define LINEAR_IFM_CNT 4//32
#define LINEAR_OFM_CNT 1

//===============

#define CONV3D0_IFM_DIM 13
#define CONV3D0_WT_DIM 3
#define CONV3D0_PAD 1
#define CONV3D0_STRIDE 1
#define CONV3D0_OFM_DIM (((CONV3D0_IFM_DIM + 2 * CONV3D0_PAD - CONV3D0_WT_DIM) / CONV3D0_STRIDE) + 1)
#define CONV3D0_IFM_CHN 192//128
#define CONV3D0_OFM_CHN 384//256
#define CONV3D0_IFM_CHN_SCALE (CONV3D0_IFM_CHN / CONV3D_NUM_CONV2D)

#define CONV3D0_WT_SIZE_CEIL  (((CONV3D0_WT_DIM  * CONV3D0_WT_DIM  + 15) / 16) * 16)
#define CONV3D0_IFM_SIZE_CEIL (((CONV3D0_IFM_DIM * CONV3D0_IFM_DIM + 15) / 16) * 16)
#define CONV3D0_OFM_SIZE_CEIL (((CONV3D0_OFM_DIM * CONV3D0_OFM_DIM + 15) / 16) * 16)

#define CONV3D0_WT_LEN  (CONV3D0_OFM_CHN * CONV3D0_IFM_CHN * CONV3D0_WT_SIZE_CEIL)
#define CONV3D0_IFM_LEN (CONV3D0_IFM_CHN * CONV3D0_IFM_SIZE_CEIL)
#define CONV3D0_OFM_LEN (CONV3D0_OFM_CHN * CONV3D0_OFM_SIZE_CEIL)

//===============

#define CONV3D1_IFM_DIM 13
#define CONV3D1_WT_DIM 3
#define CONV3D1_PAD 1
#define CONV3D1_STRIDE 1
#define CONV3D1_OFM_DIM (((CONV3D1_IFM_DIM + 2 * CONV3D1_PAD - CONV3D1_WT_DIM) / CONV3D1_STRIDE) + 1)
#define CONV3D1_IFM_CHN (CONV3D0_OFM_CHN)
#define CONV3D1_OFM_CHN 256
#define CONV3D1_IFM_CHN_SCALE (CONV3D1_IFM_CHN / CONV3D_NUM_CONV2D)

#define CONV3D1_WT_SIZE_CEIL  (((CONV3D1_WT_DIM  * CONV3D1_WT_DIM  + 15) / 16) * 16)
#define CONV3D1_IFM_SIZE_CEIL (((CONV3D1_IFM_DIM * CONV3D1_IFM_DIM + 15) / 16) * 16)
#define CONV3D1_OFM_SIZE_CEIL (((CONV3D1_OFM_DIM * CONV3D1_OFM_DIM + 15) / 16) * 16)

#define CONV3D1_WT_LEN  (CONV3D1_OFM_CHN * CONV3D1_IFM_CHN * CONV3D1_WT_SIZE_CEIL)
#define CONV3D1_IFM_LEN (CONV3D1_IFM_CHN * CONV3D1_IFM_SIZE_CEIL)
#define CONV3D1_OFM_LEN (CONV3D1_OFM_CHN * CONV3D1_OFM_SIZE_CEIL)

#define CONV3D1_MEM_OFFSET (CONV3D0_IFM_LEN + CONV3D0_WT_LEN)

//===============
//
//#define CONV3D2_IFM_DIM 13
//#define CONV3D2_WT_DIM 3
//#define CONV3D2_PAD 1
//#define CONV3D2_STRIDE 1
//#define CONV3D2_OFM_DIM (((CONV3D2_IFM_DIM + 2 * CONV3D2_PAD - CONV3D2_WT_DIM) / CONV3D2_STRIDE) + 1)
//#define CONV3D2_IFM_CHN (CONV3D1_OFM_CHN)
//#define CONV3D2_OFM_CHN 128
//#define CONV3D2_IFM_CHN_SCALE (CONV3D2_IFM_CHN / CONV3D_NUM_CONV2D)
//
//#define CONV3D2_WT_SIZE_CEIL  (((CONV3D2_WT_DIM  * CONV3D2_WT_DIM  + 15) / 16) * 16)
//#define CONV3D2_IFM_SIZE_CEIL (((CONV3D2_IFM_DIM * CONV3D2_IFM_DIM + 15) / 16) * 16)
//#define CONV3D2_OFM_SIZE_CEIL (((CONV3D2_OFM_DIM * CONV3D2_OFM_DIM + 15) / 16) * 16)
//
//#define CONV3D2_WT_LEN  (CONV3D2_OFM_CHN * CONV3D2_IFM_CHN * CONV3D2_WT_SIZE_CEIL)
//#define CONV3D2_IFM_LEN (CONV3D2_IFM_CHN * CONV3D2_IFM_SIZE_CEIL)
//#define CONV3D2_OFM_LEN (CONV3D2_OFM_CHN * CONV3D2_OFM_SIZE_CEIL)
//
//#define CONV3D2_MEM_OFFSET (CONV3D1_IFM_LEN + CONV3D1_WT_LEN)

//===============

#define LINEAR0_IFM_LEN (CONV3D1_OFM_LEN)
#define LINEAR0_OFM_LEN 4096

#define LINEAR0_IFM_LEN_CEIL (((LINEAR0_IFM_LEN + 15) / 16) * 16)
#define LINEAR0_OFM_LEN_CEIL (((LINEAR0_OFM_LEN + 15) / 16) * 16)
#define LINEAR0_WT_LEN       (LINEAR0_IFM_LEN_CEIL * LINEAR0_OFM_LEN)

#define LINEAR0_MEM_OFFSET (CONV3D1_MEM_OFFSET + CONV3D1_IFM_LEN + CONV3D1_WT_LEN)

//===============

#define LINEAR1_IFM_LEN (LINEAR0_OFM_LEN)
#define LINEAR1_OFM_LEN 4096

#define LINEAR1_IFM_LEN_CEIL (((LINEAR1_IFM_LEN + 15) / 16) * 16)
#define LINEAR1_OFM_LEN_CEIL (((LINEAR1_OFM_LEN + 15) / 16) * 16)
#define LINEAR1_WT_LEN       (LINEAR1_IFM_LEN_CEIL * LINEAR1_OFM_LEN)

#define LINEAR1_MEM_OFFSET (LINEAR0_MEM_OFFSET + LINEAR0_IFM_LEN + LINEAR0_WT_LEN)

//===============

#define LINEAR2_IFM_LEN (LINEAR1_OFM_LEN)
#define LINEAR2_OFM_LEN 1000

#define LINEAR2_IFM_LEN_CEIL (((LINEAR2_IFM_LEN + 15) / 16) * 16)
#define LINEAR2_OFM_LEN_CEIL (((LINEAR2_OFM_LEN + 15) / 16) * 16)
#define LINEAR2_WT_LEN       (LINEAR2_IFM_LEN_CEIL * LINEAR2_OFM_LEN)

#define LINEAR2_MEM_OFFSET (LINEAR1_MEM_OFFSET + LINEAR1_IFM_LEN + LINEAR1_WT_LEN)

#endif
